"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React$1=require("react"),React$1__default=_interopDefault(React$1),invariant=_interopDefault(require("invariant")),isEqual=_interopDefault(require("fast-deep-equal")),FormContext=React$1.createContext(null);const FormRefContext=React$1.createContext(null),FormControllerContext=React$1.createContext(null),cloneObject=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign({},e,r)},newObject=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var r=arguments.length,t=new Array(r>1?r-1:0),o=1;o<r;o++)t[o-1]=arguments[o];return 0===t.length?cloneObject(e):t.reduce((r,t)=>cloneObject(r,"function"==typeof t&&t(e,r)||t),cloneObject(e))},TYPE_NULL="null",TYPE_UNDEFINED="undefined",TYPE_STRING="string",TYPE_ARRAY="array",TYPE_BOOLEAN="boolean",TYPE_OBJECT="object",TYPE_FUNCTION="function",TYPE_ERROR="error",TYPE_SYMBOL="symbol",TYPE_GENERATOR_FUNCTION="generatorFunction",type={"[object Null]":"null","[object Undefined]":"undefined","[object String]":"string","[object Array]":"array","[object Boolean]":"boolean","[object Object]":"object","[object Function]":"function","[object Error]":"error","[object Symbol]":"symbol","[object GeneratorFunction]":"generatorFunction"},typeOf=e=>void 0===e?typeof e:type[Object.prototype.toString.call(e)]||typeof e,_uniqueId={},generateTimeStamp=()=>(new Date).getTime(),generateUniqueId=function e(){const r=Math.floor(Math.random()*generateTimeStamp());return _uniqueId[r]?e():(_uniqueId[r]=r,r)},deleteUniqueId=e=>delete _uniqueId[e],IS_SCHEMA=`_schema_id_@_${generateTimeStamp()}_@_`,IS_FORMREF=`${IS_SCHEMA}_ref`,IS_MULTIPLE=`${IS_SCHEMA}_multiple`,IS_LITERAL_VALUE="_schema_id_@__literal_@_",SCHEMA_CONFIG=`${IS_SCHEMA}_config`,ON_CHANGE="onChange",ON_BLUR="onBlur",VALUE="value",ERROR="error",_getPlatformBasedFieldValue=e=>e&&"object"==typeof e&&e.target&&"function"==typeof e.preventDefault?e.target.value:e,_getPlatformBasedFieldName=e=>e&&"object"==typeof e&&e.target&&"function"==typeof e.preventDefault?e.target.name:void 0,_checkType=(e,r)=>newObject("function"==typeof e?e(r):e),_trimStrings=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&"string"==typeof e&&String(e)){const t=String(e).trim();return r?Number(t):t}return e},_setInitialValues=e=>{let{formConfig:r,initialValues:t={},formRef:o,isMultiple:n,isError:i}=e;const a=e=>{const o=r[e]||{};return e in t?"function"==typeof t[e]?t[e]():t[e]:"default"in o?o.default:""},u=(n&&Array.isArray(t)?t:[t]).reduce((e,t)=>{if(r[IS_MULTIPLE])return[];const u=Object.entries(r||{}).reduce((e,r)=>{let[n,u={}]=r;return newObject(e,n in t?{[n]:u&&(u[IS_SCHEMA]||u[IS_MULTIPLE]||u._formId_)?_setInitialValues({formRef:u._formId_?u:o&&o.current&&o.current._schema[n].formRef,initialValues:t[n]||{},formConfig:u._formId_?u.getFormConfig():u[SCHEMA_CONFIG],isMultiple:u[IS_MULTIPLE],isError:i}):i?t[n]||null:a(n)}:{[n]:i?t[n]||null:a(n)})},{});return n?e.concat([u]):u},n?[]:{});return o&&o.current&&(o.current[i?"errors":"values"]=u),u},_setInitialErrors=e=>_setInitialValues({...e,isError:!0});function _deepCopy(e,r,t){if(null===e||"object"!=typeof e)return e;if("function"==typeof e.clone)return e.clone(!0);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);if(e.nodeType&&"function"==typeof e.cloneNode)return e.cloneNode(!0);void 0===r&&(r=[],t=[]);var o=r.length;for(i=0;i<o;i++)if(e===r[i])return t[i];if("[object Array]"==Object.prototype.toString.call(e)){var n=e.slice();r.push(e),t.push(n);for(var i=n.length;i--;)n[i]=_deepCopy(n[i],r,t);return n}var a=Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__;a||(a=e.constructor.prototype);var u=Object.create(a);for(var c in r.push(e),t.push(u),e)u[c]=_deepCopy(e[c],r,t);return u}const checkKey=(e,r,t)=>{const o=Array.isArray(t)?t:[t];invariant(o.includes(typeOf(e)),r)},checkIsValidConfig=e=>e[IS_SCHEMA]||e[IS_MULTIPLE],newSchema=e=>(checkIsValidConfig(e||{})&&checkKey(!1,"(newSchema) Invalid form schema","object"),{[IS_SCHEMA]:!0,[SCHEMA_CONFIG]:e}),newFormArray=e=>(e[IS_MULTIPLE]&&checkKey(!1,"(newMultiple) Invalid form schema","object"),{[IS_MULTIPLE]:!0,[SCHEMA_CONFIG]:e[IS_SCHEMA]?e._config:e}),TYPE_STRING$1="string",TYPE_ARRAY$1="array",TYPE_OBJECT$1="object",TYPE_FUNCTION$1="function",ID_KEY="id",Consumer=React$1.memo(e=>{let{children:r,...t}=e;return"function"==typeof r?r(t):r},(e,r)=>e.inputProps.value===r.inputProps.value&&e.inputProps.error===r.inputProps.error&&e.inputProps.lastUpdated===r.inputProps.lastUpdated);var FormConsumer=e=>{let{children:r,...t}=e;const o=React$1.useRef({}),{inputProps:n={},idKey:i,onSubmit:a,setInputProps:u}=React$1.useContext(FormContext)||{},{render:c,inputConfig:l,...f}=React$1.useContext(FormControllerContext)||{},s={...t.inputConfig,...l},{formRef:_,renderForm:m}=React$1.useContext(FormRefContext)||{};let d=n[t[i||"id"]]||{};d._fieldConfig&&(o.current.inputConfig&&Object.keys(o.current.inputConfig).forEach(e=>{let[r,t]=e;delete d._fieldConfig[r]}),d._fieldConfig._initiated=!0,"object"===typeOf(s)&&Object.entries(s).forEach(e=>{let[r,t]=e;void 0!==t&&(d._fieldConfig[r]=t)}),_.setFormConfig({..._.getFormConfig(),[t[i||"id"]]:newObject(d._fieldConfig||{},{_initiated:!0,render:!!(void 0!==s.render?s.render:void 0!==c?c:m||c)})},[t[i||"id"]],!1),_._renderForm(!0));const p=_.getInputProps();if(!(t[i||"id"]in p||o.current.id)){if(o.current.id=t[i||"id"],IS_LITERAL_VALUE in p)throw new Error(`Invalid: "${t[i||"id"]}" cannot add any field to literal value `);_.modifyFormConfig({[t[i||"id"]]:newObject(s||{},{_initiated:!0,render:!!(void 0!==s.render?s.render:m||c)})}),_._setInputProps(),_._renderForm(),_.renderForm()}React$1.useEffect(()=>(u(),()=>{d._fieldConfig&&(d._fieldConfig._initiated=!1,"object"===typeOf(s)&&Object.keys(s).forEach(e=>{d._fieldConfig[e]=d._defaultConfig[e]})),o.current.id&&n[IS_SCHEMA].deleteFormConfig([o.current.id]),n[IS_SCHEMA].resetFormInput([t[i||"id"]],!!o.current.id),n[IS_SCHEMA].onFormChangeCallback()}),[_._formId_]),o.current.inputConfig=s,d.error&&d[IS_SCHEMA].validateField(void 0===d.value?"":d.value);const g=_.getInputProps()[t[i||"id"]]||{},I={inputProps:{...g.inputProps||{},...f},_inputFieldConfig:g._config,...a?{onSubmit:a}:{},...t};return React$1__default.createElement(Consumer,I,r)};const getFormRef=(e,r)=>{let t=e;return t._isSchema_or_isMultiple_config_is_root&&(t=t._schema[t._isSchema_or_isMultiple_config_is_root].formRef),t=r?t&&t._schema[r]&&t._schema[r].formRef:t};var FormProvider=React$1.forwardRef((e,r)=>{let{children:t,idKey:o,onSubmit:n,formRef:i,extraProps:a,id:u,renderForm:c}=e;const l=React$1.useRef({}),[f,s]=React$1.useState(),{formRef:_,renderForm:m,setRefresh:d,rootFormRef:p}=React$1.useContext(FormRefContext)||{},g=p||i;let I;I=(e=>{d&&d(e),s(e)}),l.current.__setRefresh=I;const R=void 0!==c?c:m,F=React$1.useRef({});let E=i||_,C=getFormRef(E,u);if(!C&&u){F.current.id=u;let e=E.modifyFormConfig({[u]:newSchema({})}),r=getFormRef(E=e,u);C=r}C._setRenderForm||(C._ref(IS_FORMREF)._setRenderForm=E._setRenderForm);const[y,h]=React$1.useState(()=>C&&C.getInputProps(a));return React$1.useEffect(()=>{h(C&&C.getInputProps(a))},[C._formId_]),C&&C._formId_&&(C._ref(IS_FORMREF)._setInputProps=_?e=>{_._renderInputProps&&_._renderInputProps(),h(e)}:h),React$1.useEffect(()=>()=>{C&&C._ref(IS_FORMREF)._setInputProps&&delete C._ref(IS_FORMREF)._setInputProps,C&&C._ref(IS_FORMREF)._extraProps&&delete C._ref(IS_FORMREF)._extraProps},[C._formId_]),React$1.useEffect(()=>()=>{F.current.id&&(E.deleteFormConfig([F.current.id]),l.current.__setRefresh({}))},[E._formId_]),C&&C._formId_&&(C._ref(IS_FORMREF)._extraProps=a),React$1.useEffect(()=>(C._ref(IS_FORMREF)._is_form_initiated=!0,C._renderForm(),C.renderForm(),()=>{C._ref(IS_FORMREF)._is_form_initiated=!1,C._renderForm(),C.renderForm()}),[C._formId_]),g._formRef.__formRef__.values=g._formRef.__formRef__.getValues(),g._formRef.__formRef__.errors=g._formRef.__formRef__.getErrors(),React$1__default.createElement(FormContext.Provider,{value:{inputProps:y,idKey:o,onSubmit:n,setInputProps:()=>h(C.getInputProps(a)),formId:E._formId_}},React$1__default.createElement(FormRefContext.Provider,{value:{formRef:C,formId:C._formId_,renderForm:R,lastUpdated:C._lastUpdated,setRefresh:I,rootFormRef:p||i}},r&&"current"in r&&(r.current=C)&&null,"function"==typeof t?t(y,{values:C.getValues(),errors:C.getErrors(),formRef:C}):t))});const convertToOriginalData=e=>"object"===typeOf(e)&&IS_LITERAL_VALUE in e?e[IS_LITERAL_VALUE]:e,generateNewFormRef=(e,r,t,o,n)=>{const i="object"===typeOf(r)||void 0===r?r:{[IS_LITERAL_VALUE]:r};return e._formValidationHandler(newObject({...newObject(e._initialConfig),FORM_CONFIG:n?newFormArray({}):newObject(e._initialConfig.FORM_CONFIG),initialState:i||{},renderFormCallback:o._setRenderForm,_rootRef:{current:o},getFormData:o._isRenderForm?t._setRenderForm:void 0}))},_getFormRef=(e,r)=>{let t=e;return t._isSchema_or_isMultiple_config_is_root&&(t=t._schema[t._isSchema_or_isMultiple_config_is_root].formRef),t=r?t&&t._schema[r]&&t._schema[r].formRef:t};var MultipleFormProvider=React$1.forwardRef((e,r)=>{let{children:t,formRef:o,noAutoLoop:n,id:i,renderForm:a,initialCount:u=1}=e;const{formRef:c,setRefresh:l,renderForm:f,rootFormRef:s}=React$1.useContext(FormRefContext)||{},{setInputProps:_}=React$1.useContext(FormContext),m=React$1.useRef({}),d=void 0!==a?a:f,p=s||o;let g=o||c;const I=_getFormRef(g,i);let R=I;if(R)I&&o&&!I._multipleConfig&&I._parentRef&&I._parentRef.modifyFormConfig({[I._parentId]:{...I._parentConfig[I._parentId],[SCHEMA_CONFIG]:newFormArray({})}});else if(i){m.current.id=i;let e=g.modifyFormConfig({[i]:newFormArray({})}),r=_getFormRef(g=e,i);R=r}const F=React$1.useRef({}),[E,C]=React$1.useState();let y;y=(e=>{l&&l(e),C(e)});const[h,S]=React$1.useState(()=>(()=>R[IS_MULTIPLE]._initialValues.length>0?R[IS_MULTIPLE]._initialValues.map(e=>generateNewFormRef(R,e,c,p,!!c._multipleConfig)):[...Array("number"==typeof u?u:0)].map(e=>generateNewFormRef(R,e,c,p,!!c._multipleConfig)))());F.current.formRefArray=h;React$1.useCallback((e,r)=>{S(t=>{const o={...t},n=o.slice(),i=n[e];return"number"==typeof r&&"number"==typeof e&&(n.splice(e,1),n.splice(r,0,i),o[e]=n),o})},[]);const v=e=>{const r=h.find(r=>{let{formId:t}=r;return t===e});r&&r.formRef.resetForm()},O=e=>{const r=h.find(r=>{let{formId:t}=r;return t===e});r&&r.formRef.clearForm()},P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;S(o=>{let n=o.slice();const i=[...Array(t)].map((r,t)=>generateNewFormRef(R,e[t],c,p));return"number"==typeof r?n.splice(r,0,...i):n.concat(i),n})}(Array.isArray(e)?e:"object"===typeOf(e)?[e]:[],r,t)},L=React$1.useCallback(function(){!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>0&&S(r=>r.slice().filter(r=>{let{formId:t}=r;return!e.includes(t)}))}([arguments.length>0&&void 0!==arguments[0]?arguments[0]:""])},[]);r&&"current"in r&&(r.current.formArray=h);const b=React$1.useCallback(()=>{return F.current.formRefArray.map(e=>{let{formRef:r}=e;return convertToOriginalData(r.getValues())})},[]),M=React$1.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;if(!Array.isArray(e))return b();if(e.length>F.current.formRefArray.length){const r=e.slice(F.current.formRefArray.length).map(e=>generateNewFormRef(R,e,c,p));S(F.current.formRefArray.concat(r))}return F.current.formRefArray.map((t,o)=>{let{formRef:n}=t;return n.setInitialFormData(e[o]||{},r)})},[]),A=React$1.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;return F.current.formRefArray.map((t,o)=>{let{formRef:n}=t;return n.setFormErrors(e[o]||{},r)})},[]),T=React$1.useCallback(()=>F.current.formRefArray.map(e=>{let{formRef:r}=e;return r.getFormConfig()}),[]),j=React$1.useCallback(e=>{if(e){const r=F.current.formRefArray.find(r=>{let{formId:t}=r;return t===e});return r?r.formRef:null}return F.current.formRefArray.map(e=>{let{formRef:r}=e;return r})},[]),U=React$1.useCallback(()=>F.current.formRefArray.map(e=>{let{formRef:r}=e;return convertToOriginalData(r.getErrors())}),[]),V=React$1.useCallback(e=>F.current.formRefArray.map(r=>{let{formRef:t}=r;return t.resetForm(e)}),[]),N=React$1.useCallback(e=>F.current.formRefArray.map(r=>{let{formRef:t}=r;return t.clearForm(e)}),[]),$=React$1.useCallback(()=>F.current.formRefArray.length?F.current.formRefArray.map(e=>{let{formRef:r}=e;return r.getSampleForm()}):[],[]),w=React$1.useCallback(e=>F.current.formRefArray.reduce((r,t)=>{let{formRef:o}=t;const n=o.validateForm(e);return{errorCount:r.errorCount+n.errorCount,isError:r.isError||n.isError,isValidatePassed:r.isValidatePassed||n.isValidatePassed,totalErrorCount:r.totalErrorCount+n.totalErrorCount,errors:r.errors.concat([n.errors]),values:r.values.concat([n.values])}},{errors:[],values:[],errorCount:0,totalErrorCount:0,isError:!1,isValidatePassed:!1}),[]);r&&"current"in r&&(r.current.formArray=h),R[IS_MULTIPLE].getValues=b,R[IS_MULTIPLE].getErrors=U,R[IS_MULTIPLE].validateForm=w,R[IS_MULTIPLE].resetForm=V,R[IS_MULTIPLE].getSampleForm=$,R[IS_MULTIPLE].getFormConfig=T,R[IS_MULTIPLE].getFormRef=j,R[IS_MULTIPLE].setInitialFormData=M,R[IS_MULTIPLE].setFormErrors=A,R[IS_MULTIPLE].clearForm=N,R.getValues=b,R.getErrors=U,R.formRefArray=h,R.setFormValues=M,R.setInitialFormData=M,R.setFormErrors=A,R.getSampleForm=$,R.validateForm=w,R.getFormConfig=T,R.getFormRef=j,R.resetForm=V,R.clearForm=N,R.count=h.length,R.values=b(),R.errors=U(),p._formRef.__formRef__.values=p._formRef.__formRef__.getValues(),p._formRef.__formRef__.errors=p._formRef.__formRef__.getErrors(),React$1.useEffect(()=>(R._ref(IS_FORMREF)._is_form_initiated=!0,R._renderForm(),R.renderForm(),()=>{R._ref(IS_FORMREF)._is_form_initiated=!1,R._renderForm(),R.renderForm()}),[R._formId_]),React$1.useEffect(()=>()=>{m.current.id&&(g.deleteFormConfig([m.current.id]),g.renderForm())},[g._formId_]),R._ref(IS_FORMREF)._setRenderForm||(R._ref(IS_FORMREF)._setRenderForm=c._setRenderForm),R&&R._formId_&&(R?R._ref(IS_FORMREF)._setInputProps=(e=>{g._renderInputProps&&g._renderInputProps(),C({})}):R._setInputProps=C);const x={ref:R,...R},H=e=>{const r={count:h.length,append:r=>P(r,e+1),reset:v.bind(null,h[e].formId),clear:O.bind(null,h[e].formId),delete:L.bind(null,h[e].formId),prepend:r=>{P(r,0===e?0:e)}};return{...r,form:r}};return React$1__default.createElement(FormContext.Provider,{value:{formId:g._formId_,setInputProps:_}},React$1__default.createElement(FormRefContext.Provider,{value:{formRef:R,formId:R._formId_,lastUpdated:R._lastUpdated,renderForm:d,setRefresh:y,rootFormRef:s||o}},n?"function"==typeof t?t(h,x):t:h.map((e,r)=>"function"==typeof t?t({...e,...H(r),index:r},x,r):t)))});const FormController=e=>{let{children:r,hide:t,render:o,inputConfig:n,...i}=e;return t?null:React.createElement(FormControllerContext.Provider,{value:{render:o,inputConfig:n,...i}},r)},emailRegex=/^([\w.+-]+@[a-zA-Z0-9.-]+\.[a-zA-z0-9]{2,4})$/;function validateEmail(e){return emailRegex.test(String(e).toLowerCase())}function validate(e,r){let{optional:t,minLength:o,isRequired:n,message:i={},length:a,regex:u,key:c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((t||!n)&&!e)return"";const l="number"!=typeof e&&"boolean"!=typeof e&&!e;if(e&&o&&e.length<o)return i&&void 0!==i.minLength?i.minLength:`Minimum ${o} characters is required`;if(e&&a&&e.length!==a)return i&&i&&void 0!==i.length?i.length:`Number should be ${a} digits long`;switch(r){case"password":return l?i&&void 0!==i.required?i.required:"This field is required":"";case"email":return l?i&&void 0!==i.required?i.required:"Please enter your email":e&&!validateEmail(e)?i&&void 0!==i.invalid?i.invalid:"Invalid email address":"";case"name":return l?i&&void 0!==i.required?i.required:"Please enter your name":"";case"mobileNumber":return l?i&&void 0!==i.required?i.required:"Please enter 10 digit mobile number":"";case"about":return l?i&&void 0!==i.required?i.required:"This field is required":"";default:if(l)return i&&void 0!==i.required?i.required:"This field is required";if(u){if("[object RegExp]"===Object.prototype.toString.call(u))return u.test(e)?"":i&&void 0!==i.regex?i.regex:`${c} is invalid `;console.error(`${c} is invalid `)}return""}}const formValidationHandler=function(){let{ON_CHANGE_KEY:e,ON_BLUR_KEY:r,VALUE_KEY:t,ERROR_KEY:o,VALIDATOR:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=[],a={};const u=function(){let{VALIDATOR:c=n||validate,initialState:l={},getFormData:f,renderFormCallback:s=f,FORM_CONFIG:_={},ON_CHANGE_KEY:m=e||ON_CHANGE,ON_BLUR_KEY:d=r||ON_BLUR,VALUE_KEY:p=t||VALUE,ERROR_KEY:g=o||ERROR,[IS_MULTIPLE]:I,_formRef:R,_objKey:F="",_schemaKey:E,_initialErrors:C={},ref:y,_rootRef:h,_parentRef:S,_parentConfig:v,_parentId:O}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function P(){}const L={current:new P};P.prototype.is_validate_form_triggered=!1,P.prototype._schema={},P.prototype._formRef={},P.prototype._formIds=[];const b=R||L,M=e=>{deleteUniqueId(e),delete a[e];const r=b.current._formIds.filter(r=>r!==e);b.current._formIds=r,i=r};let A,T=_deepCopy(_);E||(T[IS_MULTIPLE]?(T={[IS_MULTIPLE]:T},A=IS_MULTIPLE):T[IS_SCHEMA]&&(T={[IS_SCHEMA]:T},A=IS_SCHEMA)),P.prototype._formConfig=_deepCopy(T);const j=I||A===IS_MULTIPLE;P.prototype._isMultipleForm=j,A&&(P.prototype._isSchema_or_isMultiple_config_is_root=A),j&&console.log(l),P.prototype[IS_MULTIPLE]={_initialValues:j&&Array.isArray(l)?l.slice():[]},P.prototype._schema=L.current._schema;const U=e=>A?e[A]:e,V={initialValues:Array.isArray(l)?l.slice():newObject(l),Validate:c,getFormData:f,renderFormCallback:s,FORM_CONFIG:T,ON_CHANGE_KEY:m,ON_BLUR_KEY:d,VALUE_KEY:p,ERROR_KEY:g};P.prototype._initialFormConfig=V.FORM_CONFIG,P.prototype._initialConfig=V;const N=generateUniqueId();a[N]=L.current,i.push(N),b.current._formIds.push(N);let $=V.FORM_CONFIG;const w=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;const n=e||$;I&&e[IS_MULTIPLE]?P.prototype._multipleConfig=newObject(e):Object.entries(n).forEach(e=>{let[i,a]=e;if(o&&!o.includes(i))return;b.current._formRef.__formRef__||(b.current._formRef.__formRef__=L.current);const c=`${F?`${F}_`:""}${i}`;if((a[IS_SCHEMA]||a[IS_MULTIPLE])&&a[SCHEMA_CONFIG]||a._formId_){a[SCHEMA_CONFIG]?a[SCHEMA_CONFIG]=newObject(a[SCHEMA_CONFIG]):a._formId_&&(a._initialConfig=newObject(a._initialConfig),a._initialFormConfig=newObject(a._initialFormConfig));const e=L.current._schema[i]&&L.current._schema[i].formRef._formId_;e&&M(e);const o=u({...a._formId_?a._initialConfig:V,FORM_CONFIG:a._formId_?a._initialFormConfig:L.current._schema[i]&&L.current._schema[i].formRef.getFormConfig()||a[SCHEMA_CONFIG],ref:y,initialState:r[i]||l[i],_formRef:b,_formRef:b,_objKey:c,_parentRef:L.current,_schemaKey:i,_parentConfig:n,_parentId:i,_initialErrors:t[i]||C[i],[IS_MULTIPLE]:a[IS_MULTIPLE]});L.current._hasChildRef=!0,L.current._schema[i]=o,b.current._formRef[c]=o}else o&&(H[i]=L.current._resetValue(i))})};w($,l,C);const x=e=>r=>{const t=$[r]||{};return e?"default"in t?t.default:"":r in l?"function"==typeof l[r]?l[r]():l[r]:"default"in t?t.default:""};P.prototype._resetValue=x(!1),P.prototype._clearValue=x(!0);let H=_setInitialValues({formConfig:$,initialValues:l,formRef:L,isMultiple:I}),k=_setInitialErrors({formConfig:$,initialValues:C,formRef:L,isMultiple:I});P.prototype.formConfig=$;const q=e=>{if(b.current.getValues){L.current.values=L.current.getValues(),L.current.errors=L.current.getErrors(),P.prototype.formConfig=L.current.getFormConfig();const e=b.current.getValues(),r=b.current.getErrors(),t=b.current.getFormConfig();b.current.values=e,b.current.errors=r,b.current._ref(IS_FORMREF).formConfig=t,y&&"current"in y&&(y.current=y.current||{},y.current.values=e,y.current.errors=r,y.current.sampleFormObject=le())}"function"!==typeOf(f)||e||setTimeout(()=>{if(b.current.getValues){const e={values:(h||b).current.getValues(),errors:(h||b).current.getErrors(),formConfig:(h||b).current.getFormConfig()};isEqual(e,b.current.oldData)||(b.current.oldData=e,f(e))}})},D=function(e,r){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=_deepCopy(e);P.prototype._initialFormConfig=_deepCopy(e),P.prototype._formConfig=o,P.prototype.formConfig=o;const n=L.current.getValues(),i=L.current.getErrors();P.prototype.formConfig=_checkType(e,L.current.formConfig),$=o;const a=Math.floor(Math.random()*generateTimeStamp());var u;return L.current.lastUpdated=a,t&&(u=r,(Array.isArray(u)?u:Object.keys(u)).reduce((e,r)=>{const t=L.current._schema[r]&&L.current._schema[r].formRef,o=t&&t._formId_;return o&&M(o),delete L.current._schema[r],delete L.current._schema[r],{...e,[r]:{}}},{}),(e=>{(Array.isArray(e)?e:Object.keys(e)).forEach(e=>{const r=`${F?`${F}_`:""}${e}`;delete L.current._formRef[r]})})(r),w(e,newObject(n),newObject(i),r),q(!t),"function"===typeOf(L.current._setInputProps)&&L.current._setInputProps(L.current.getInputProps(L.current._extraProps||b.current._extraProps))),L.current},G=(e,r)=>{L.current.values=_checkType(e,L.current.values),H=_checkType(e,H),q(),setTimeout(()=>{"function"!==typeOf(L.current._setInputProps)||r||L.current._setInputProps(L.current.getInputProps(L.current._extraProps||b.current._extraProps))})},Y=(e,r)=>{L.current.errors=_checkType(e,L.current.errors),k=L.current.errors,q(),"function"!==typeOf(L.current._setInputProps)||r||L.current._setInputProps(L.current.getInputProps(L.current._extraProps||b.current._extraProps))},K=function(e,r,t,o,n){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6?arguments[6]:void 0;const u=n||L.current.formConfig[r]||{};let{value:l,error:f}=u&&u.validator?u.validator(e,{formRef:L.current,values:H,errors:k},u._config,u._commonInputProps):{value:e},s=null,_=null;if(!u._noValidate&&u._initiated?((void 0!==u.trim?u.trim:u.trim||i)&&(l=_trimStrings(l,u.isNumber)),u.maxLength&&(l||"").length>u.maxLength&&(_=void 0!==(u.message&&u.message.maxLength)?u.message.maxLength:`maximum ${u.maxLength} characters are allowed`,l=l.slice(0,u.maxLength)),u&&(s=f||c(l,u.type,{key:r,optional:u.optional,minLength:u.minLength,message:u.message,maxLength:u.maxLength,length:u.length,...u})||_,l&&u.match&&"string"==typeof u.match&&H[u.match]&&(s=H[u.match]!==l?void 0!==(u.message&&u.message.match)?u.message.match:`${r} not matching with ${u.match}`:_)),r&&t&&(""!==l&&["string","number"].includes(typeof l)&&!Number.isNaN(+l)&&u.allowValidNumber&&!+l?s=void 0!==(u.message&&u.message.allowValidNumber)?u.message&&u.message.allowValidNumber:"Please enter valid number":u.allowOnlyNumber&&Number.isNaN(+l)?s=void 0!==(u.message&&u.message.allowOnlyNumber)?u.message&&u.message.allowOnlyNumber:"Only numbers are allowed":G({...H,[r]:l},a))):G({...H,[r]:l},a),"function"==typeof u.callback){const e=u.callback({error:s,value:l,key:r,formRef:L.current,values:H,errors:k,is_validation_allowed:!u._noValidate},L.current.formConfig[r]._config,L.current.formConfig[r]._commonInputProps);"object"===typeOf(e)&&(G({...H,[r]:e.value},a),s=e.error)}return o&&Y({...k,[r]:s||null},a),{error:s,value:l,key:r}},B=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,{value:t,isStopPropagation:o,isValidateOnly:n,config:i,isSetError:a=!0,trim:u,dontRender:c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&"function"==typeof e.preventDefault&&e.preventDefault(),e&&o&&"function"==typeof e.stopPropagation&&e.stopPropagation();let l=void 0!==t?t:_getPlatformBasedFieldValue(e);const f=_getPlatformBasedFieldName(e),s=r||f;if(n||!s)return K(l,s,null,null,i,u,c);K(l,s,!0,a,void 0,u,c)},z=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=_getPlatformBasedFieldName(e),n=r||o,i=H[n];(void 0===t.isValidateOnBlur||t.isValidateOnBlur)&&K(i,n,!1,!0)},J=e=>{let r=L.current.validateThisForm(e);return(r=Object.entries(L.current._schema).reduce((r,t)=>{let[o,n]=t;if(n.formRef._isMultipleForm&&!n.formRef[IS_MULTIPLE].validateForm)return r;let i=n.formRef[IS_MULTIPLE].validateForm?n.formRef[IS_MULTIPLE].validateForm(e):n.formRef.validateForm(e);return{errorCount:r.errorCount+i.errorCount,isError:r.isError||i.isError,isValidatePassed:r.isValidatePassed||i.isValidatePassed,totalErrorCount:r.totalErrorCount+i.totalErrorCount,errors:newObject(r.errors,{[o]:i.errors}),values:newObject(r.values,{[o]:i.values})}},r)).values=U(r.values),r.errors=U(r.errors),r},Z=e=>r=>{const t="function"==typeof r?r(L.current.getFormConfig()):r,o=Object.keys(r);return D(e?newObject(t):{...L.current.getFormConfig(),...t},o)},Q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;e.forEach(e=>{H[e]&&B(H[e],e,r)})},W=function(e){let{index:r,config:t,propKeyMap:{onChange:o=m,onBlur:n=d,value:i=p,error:a=g}={},...u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const c=L.current.formConfig[e],l=newObject(c._commonInputProps&&c._commonInputProps._defaultConfig||c);c&&(c._config={index:r,config:t,key:e,...u});let f={[o]:r=>{B(r,e,t);const o=t&&t.validateFieldsOnChange||c&&c.validateFieldsOnChange;o&&o.length>0&&Q(o,c._config),c.render&&L.current.renderForm()},[n]:r=>z(r,e,c),[i]:H[e],[a]:k[e],keyName:e,lastUpdated:L.current.lastUpdated};return(f={formId:N,...f,...c&&("function"==typeof c.inputProps?c.inputProps(L.current,c._config,{onChange:f[o],onBlur:f[n],value:f[i],error:f[a],key:e}):c.inputProps)||{}}).inputProps={...f},f._fieldConfig=c,f._config={...L.current.formConfig[e]},f[IS_SCHEMA]={validateField:r=>{B(r,e,{...t,dontRender:!0});const o=t&&t.validateFieldsOnChange||c&&c.validateFieldsOnChange;o&&o.length>0&&Q(o,{...c._config,dontRender:!0})}},f._defaultConfig=l,delete f._config.inputProps,delete f._config._commonInputProps,c&&(c._commonInputProps={...f}),f},X=(e,r)=>{const t=e||{},o=Object.entries(L.current.formConfig).reduce((e,o)=>{let[n,i]=o;return i[IS_SCHEMA]||i._formId_||i[IS_MULTIPLE]?(L.current._schema[n].formRef.setInitialFormData(t[n],r),e):newObject(e,{[n]:n in t?t[n]:r?L.current._resetValue(n):t[n]})},{});G(o)},ee=e=>r=>{const t=Object.entries($||{}).reduce((t,o)=>{let[n,i={}]=o;const a=e?"clearForm":"resetForm";return newObject(t,i[IS_SCHEMA]||i._formId_||i[IS_MULTIPLE]?r?{}:{[n]:i[IS_MULTIPLE]?(()=>{const e=L.current._schema[n].formRef[a]();return Array.isArray(e)?e:[]})():L.current._schema[n].formRef[a]()}:{[n]:e?L.current._clearValue(n):L.current._resetValue(n)})},H);return L.current.setFormValues(newObject(t),!0),L.current.setFormErrors({},!0),t},re=()=>te(L.current._extraProps||b.current._extraProps),te=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(L.current.formConfig).reduce((r,t)=>{let[o,n]=t;return n[IS_SCHEMA]||n._formId_?r:{...r,[o]:W(o,e)}},{[IS_SCHEMA]:{addFormConfig:L.current.modifyFormConfig,deleteFormConfig:L.current.deleteFormConfig,getInputProps:re,onFormChangeCallback:q,resetFormInput:L.current.resetFormInput}})},oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={...$},t={...k};Object.entries(e).forEach(e=>{let[o,n]=e;r[o]._noValidate=!n,n||(t[o]=null)}),D(r,Object.keys(e)),Y(t)},ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={...$},t={...k};Object.entries(e).forEach(e=>{let[o,n]=e;r[o].optional=n,r[o].isRequired=!1,t[o]=null}),D(r,Object.keys(e)),Y(t),Q(Object.keys(e))},ie=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={...$},t={...k};Object.entries(e).forEach(e=>{let[o,n]=e;r[o].isRequired=n,r[o].optional=!1,t[o]=null}),D(r,Object.keys(e)),Y(t),Q(Object.keys(e))},ae=()=>U(Object.entries(L.current.getFormConfig()).reduce((e,r)=>{let[t,o]=r;const n=o[IS_SCHEMA]||o._formId_||o[IS_MULTIPLE];if((!n&&!o._initiated||n&&(!L.current._schema[t]||!L.current._schema[t].formRef._is_form_initiated))&&!A)return e;if(!n&&!o._initiated)return e;let i=o[IS_MULTIPLE]?k[t]:L.current._schema[t]&&L.current._schema[t].formRef.getValues();const a=L.current._schema[t]&&L.current._schema[t].formRef[IS_MULTIPLE].getValues;return"function"==typeof a&&(i=a()),i=o[IS_MULTIPLE]?Array.isArray(i)?i:[]:i,{...e,[t]:n?i:void 0===H[t]?"default"in o?o.default:"":H[t]}},{})),ue=()=>U(Object.entries($).reduce((e,r)=>{let[t,o]=r;const n=o[IS_SCHEMA]||o._formId_||o[IS_MULTIPLE];if((!n&&!o._initiated||n&&(!L.current._schema[t]||!L.current._schema[t].formRef._is_form_initiated))&&!A)return e;let i=o[IS_MULTIPLE]?k[t]:L.current._schema[t]&&L.current._schema[t].formRef.getErrors();const a=L.current._schema[t]&&L.current._schema[t].formRef[IS_MULTIPLE].getErrors;return"function"==typeof a&&(i=a()),{...e,[t]:n?o[IS_MULTIPLE]?Array.isArray(i)?i:[i]:i:k[t]||null}},{})),ce=()=>newObject(U(Object.entries($).reduce((e,r)=>{let[t,o]=r;if(o[IS_SCHEMA]||o._formId_||o[IS_MULTIPLE]){let r=L.current._schema[t]&&L.current._schema[t].formRef.getFormConfig;return"function"==typeof r?{...e,[t]:{...o,[SCHEMA_CONFIG]:o[IS_MULTIPLE]&&L.current._schema[t]&&L.current._schema[t].formRef[IS_MULTIPLE].getFormConfig&&L.current._schema[t].formRef[IS_MULTIPLE].getFormConfig()||r()}}:e}return{...e,[t]:o}},{}))),le=()=>U(Object.entries($).reduce((e,r)=>{let t,[o,n]=r;return t=n[IS_MULTIPLE]?L.current._schema[o]&&L.current._schema[o].formRef[IS_MULTIPLE].getSampleForm&&L.current._schema[o].formRef[IS_MULTIPLE].getSampleForm():L.current._schema[o]&&L.current._schema[o].formRef.getSampleForm(),{...e,[o]:n[IS_SCHEMA]||n._formId_||n[IS_MULTIPLE]?n[IS_MULTIPLE]?Array.isArray(t)?t:[t]:t:n.default}},{})),fe=e=>{const r={...H},t={...k};(e||[]).forEach(e=>{const o=$[e];(o[IS_SCHEMA]||o[IS_MULTIPLE])&&o[SCHEMA_CONFIG]?r[e]=L.current._schema[e].formRef.resetForm():(r[e]=L.current._resetValue(e),t[e]=null)}),G(r),Y(t)},se=e=>{const r={...H},t={...k};(e||[]).forEach(e=>{const o=$[e];(o[IS_SCHEMA]||o[IS_MULTIPLE])&&o[SCHEMA_CONFIG]?r[e]=L.current._schema[e].formRef.clearForm():(r[e]=L.current._clearValue(e),t[e]=null)}),G(r),Y(t)};return L.current.getValues=ae,L.current.getErrors=ue,L.current.setFormValues=X,L.current.setFormErrors=((e,r)=>{const t=Object.entries(L.current.formConfig).reduce((t,o)=>{let[n,i]=o;return i[IS_SCHEMA]||i._formId_||i[IS_MULTIPLE]?(L.current._schema[n].formRef.setFormErrors(e&&e[n]||{},r),t):newObject(t,{[n]:n in e||r?e[n]||null:k[n]})},{});Y(t)}),L.current.getSampleForm=le,L.current.deleteFormConfig=(e=>{const r={...$};Array.isArray(e)&&(e.forEach(e=>{"string"===typeOf(e)&&delete r[e]}),D(r,e))}),L.current.validateForm=J,L.current.modifyFormConfig=Z(!1),L.current.resetFormConfig=Z(!0),L.current.resetForm=ee(!1),L.current.clearForm=ee(!0),L.current._isMultipleForm||(L.current.setValidate=oe,L.current.setOptional=ne,L.current.setRequired=ie,L.current.setOptional=ne,L.current.setRequired=ie,L.current.resetValues=fe,L.current.clearValues=se),L.current.renderForm=(()=>{if("function"===typeOf(s)&&(h||b).current.getValues){const e={values:(h||b).current.getValues(),errors:(h||b).current.getErrors(),formConfig:(h||b).current.getFormConfig()};s(e)}}),L.current.getFormRef=(e=>{if(e&&e.length>0&&"array"===typeOf(e)){const r=L.current._formRef[e.join("_")];return r?r.formRef:null}return e?null:L.current._formRef.__formRef__}),L.current.getFormRefById=(e=>a[e]?a[e]:null),L.current._isRootRef=!R,S&&(P.prototype._parentRef=S),v&&(P.prototype._parentConfig=v),O&&(P.prototype._parentId=O),P.prototype._ref=(e=>e===IS_FORMREF?P.prototype:null),P.prototype.getInputProps=te,P.prototype.getFormConfig=ce,P.prototype.commonInputProps=W,P.prototype.setInitialFormData=X,P.prototype._renderForm=q,P.prototype.onBlurValues=z,P.prototype.onChangeValues=B,P.prototype.onValidateValues=(e=>{let{value:r,isValue:t,key:o,isValidateOnly:n,config:i,trim:a}=e;return B(r,o,{value:t?r:void 0,isValidateOnly:n,config:i,trim:a})}),P.prototype.validateThisForm=function(){let{isSetError:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};L.current.is_validate_form_triggered=!0;const r=L.current.getValues(),t=k,o=[];for(const[n,i]of Object.entries($)){if(i[IS_SCHEMA]||i[IS_MULTIPLE]||i._formId_)continue;console.log(n,r,L.current.getValues());const{error:a}=K(r[n],n,!1,!1,i,!0);t[n]=a,a&&o.push(null),e&&Y(t)}return L.current.is_validate_form_triggered=!1,{values:IS_LITERAL_VALUE in r?r[IS_LITERAL_VALUE]:r,errors:IS_LITERAL_VALUE in t?t[IS_LITERAL_VALUE]:t,totalErrorCount:o.length,errorCount:o.length,isError:o.length>0,isValidatePassed:0===o.length}},P.prototype.validateObject=((e,r)=>J({isSetError:!1,values:e,formConfig:r,isNewFormConfig:!0,isResetValue:!0,isResetError:!0})),P.prototype._onUnMountForm=(()=>{b.current._formIds.forEach(e=>{M(e),deleteUniqueId(e)})}),P.prototype.getSchema=(()=>newObject(U(Object.entries($).reduce((e,r)=>{let[t,o]=r;if(o[IS_SCHEMA]||o._formId_||o[IS_MULTIPLE]){let r=L.current._schema[t]&&L.current._schema[t].formRef.getSchema;return"function"==typeof r?{...e,[t]:{...o,[SCHEMA_CONFIG]:r()}}:e}return{...e,[t]:o}},{})))),P.prototype.setFormConfig=D,P.prototype.resetFormInput=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;const t={...H},o={...k};e.forEach(e=>{r&&!e in l?(delete t[e],delete o[e]):(t[e]=L.current._resetValue(e),o[e]=null)}),G(t),Y(o)},P.prototype.validateCustomForm=(e=>{let{isSetError:r,formConfig:t={},values:o={},errors:n={}}=e;const i=t,a=o,u=n,c=[];for(const e of Object.keys(i)){const{error:r}=K(a[e],e,!1,!1,i[e]);u[e]=r,r&&c.push(null)}return r&&Y(u),{values:a,errors:u,totalErrorCount:c.length,errorCount:c.length,isError:c.length>0,isValidatePassed:0===c.length}}),P.prototype.getFormConfig=ce,P.prototype._objKey=F,P.prototype._schema=L.current._schema,P.prototype._formValidationHandler=u,P.prototype.formConfig=newObject(L.current._formConfig),P.prototype._renderInputProps=(()=>{L.current._setInputProps(L.current.getInputProps(L.current._extraProps||b.current._extraProps))}),P.prototype._formId_=N,L.current.formId=N,P.prototype._ref=(e=>e===IS_FORMREF?P.prototype:null),L.current.values=ae(),L.current.errors=ue(),q(),{formRef:L.current,formId:N}};return{useForm:e=>{let{renderForm:r,...t}=e;const[o,n]=React$1.useState(),[{formRef:i,formId:a}]=React$1.useState(()=>u({...t,renderFormCallback:n,getFormData:r?n:void 0}));return i._ref(IS_FORMREF)._setRenderForm=n,i._ref(IS_FORMREF)._isRenderForm=r,React$1.useEffect(()=>()=>{i._onUnMountForm()},[i]),{formRef:i,formId:a}},formHandler:u,useFormRef:e=>{const[r]=React$1.useState(()=>a[e]);return{formRef:r,formId:r&&r._formId_}}}},FormProvider$1=formValidationHandler,Form={Consumer:FormConsumer,Provider:FormProvider,Controller:FormController,Multiple:MultipleFormProvider};exports.Form=Form,exports.FormProvider=FormProvider$1;
